<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="3D Embodied AI Environments Generated by LLM">
  <meta name="keywords" content="LLM, Embodied AI, Scene Generation">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>A Textbook Remedy for Domain Shifts: Knowledge Priors for Medical Image Analysis</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro|Crimson+Text"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/knobo_logo.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>

<body>

<section class="hero" style="padding-bottom: 0;">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">
            <span class="book-svg"></span>
            <span class="small-caps">A Textbook Remedy for Domain Shifts</span> Knowledge Priors for Medical Image Analysis
          </h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://yueyang1996.github.io">Yue Yang</a>, 
            </span>
            <span class="author-block">
              <a href="https://monagandhi09.github.io">Mona Gandhi</a>, 
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/yufei-wang-896938257">Yufei Wang</a>, 
            </span>
            <span class="author-block">
              <a href="https://yifannnwu.com/">Yifan Wu</a>, 
            </span>
            <span class="author-block">
              <a href="https://www.michaelsyao.com/">Michael S. Yao</a>, 
            </span>
            <br>
            <span class="author-block">
              <a href="https://www.cis.upenn.edu/~ccb/">Chris Callison-Burch</a>,
            </span>
            <span class="author-block">
              <a href="https://www.med.upenn.edu/apps/faculty/index.php/g5455356/p10656">James C. Gee</a>, 
            </span>
            <span class="author-block">
              <a href="https://www.cis.upenn.edu/~myatskar/">Mark Yatskar</a>
            </span>
            <br>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"></span></sup>University of Pennsylvania,</span>&nbsp;&nbsp;
          </div>

          <div class="is-size-5 emails">
            <span class="emails">
              <a href="mailto: yueyang1@seas.upenn.edu">yueyang1@seas.upenn.edu</a>&nbsp;&nbsp;
            </span>
            <span class="emails">
              <a href="mailto: myatskar@seas.upenn.edu">myatskar@seas.upenn.edu</a>
            </span>
          </div>

          <!-- </div> -->
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="../papers/knobo.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- arxiv Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2312.09067"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/allenai/Holodeck"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Email Link. -->
              <span class="link-block">
                <a href="mailto: yueyang1@seas.upenn.edu; myatskar@seas.upenn.edu"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-envelope"></i>
                  </span>
                  <span>Email</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="demo" style="padding-top: 0px;">
  <div class="container is-max-desktop has-text-centered">

    <video id="teaser" autoplay="" loop="" muted="" playsinline="" style="width: 80%; height: auto; margin-top: 0;">
      <source src="./static/videos/knobo_teaser.mp4" type="video/mp4">
    </video>    

    <p class="has-text-centered">
      KnoBo incorporates knowledge priors from medical documents via inherently interpretable models.
    </p>

    <br>
    <br>

    <img src="./static/images/intro_new.png"
                   class="interpolation-image"
                   alt="Interpolate start reference image."
          />
    <p class="has-text-centered" style="margin-bottom: 0; padding-bottom: 0;">
      <h2 class="subtitle has-text-adjusted" style="font-size: medium; text-align: right; margin-bottom: 10px; padding-bottom: 0;">
        [In-domain (ID), out-of-domain (OOD), and average of ID and OOD (Avg) performance on confounded medical image datasets.]
      </h2>
      KnoBo is more robust to domain shifts (e.g., race, hospital, etc) than fine-tuned vision transformers.
    </p>
  </div>
</section>

<section class="section", id="abstract">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            While deep networks have achieved broad success in analyzing natural images, when applied to medical scans, they often fail in unexcepted situations. We investigate this challenge and focus on model sensitivity to domain shifts, such as data sampled from different hospitals or data confounded by demographic variables such as sex, race, etc, in the context of chest X-rays and skin lesion images. A key finding we show empirically is that existing visual backbones lack an appropriate prior from the architecture for reliable generalization in these settings. Taking inspiration from medical training, we propose giving deep networks a prior grounded in explicit medical knowledge communicated in natural language. To this end, we introduce Knowledge-enhanced Bottlenecks (KnoBo), a class of concept bottleneck models that incorporates knowledge priors that constrain it to reason with clinically relevant factors found in medical textbooks or PubMed. KnoBo uses retrieval-augmented language models to design an appropriate concept space paired with an automatic training procedure for recognizing the concept. We evaluate different resources of knowledge and recognition architectures on a broad range of domain shifts across 20 datasets. In our comprehensive evaluation with two imaging modalities, KnoBo outperforms fine-tuned models on confounded datasets by 32.4% on average. Finally, evaluations reveal that PubMed is a promising resource for making medical models less sensitive to domain shift, outperforming other resources on diversity of information and final prediction performance.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>


<section class="section", id="motivation">
  <div class="container is-max-desktop">
    <!-- Motivation. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">Motivation: Deep Networks Lack Priors for Medical Images</h2>
        <div class="content has-text-justified">
          <p>
            Priors are an important signal allowing models to adopt appropriate hypotheses in low or misleading data regimes. Vision backbones have an effective deep image prior on natural images even when entirely untrained. In contrast, <strong>across multiple medical modalities (X-rays and skin lesion images), the deep image prior in current major visual backbones is no more effective than using pixels (and often worse)</strong>.
          </p>
        </div>

          <img src="./static/images/natural_vs_medical.png"
                   class="interpolation-image"
                   alt="Interpolate start reference image."
          />
          
          <h2 class="subtitle has-text-adjusted" style="font-size: medium; text-align: right;">
            [Classification performance on natural and medical images through linear probing using features extracted from untrained models versus pixels features.]
          </h2>

        
      </div>
  </div>
</section>


<section class="section", id="method">
  <div class="container is-max-desktop">
    <!--  Method. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">Knowledge-enhanced Bottlenecks</h2>
        <div class="content has-text-justified">
          <p>
            Our Knowledge-enhanced Bottlenecks for medical image classification comprises three main components: <br> (1) <strong>Structure Prior</strong> constructs the trustworthy knowledge bottleneck by leveraging medical documents; <br> (2) <strong>Bottleneck Predictor</strong> grounds the images onto concepts which are used as input for the linear layer; <br> (3) <strong>Parameter Prior</strong> constrains the learning of linear layer with parameters predefined by doctors or LLMs.
          </p>
        </div>

        <video id="teaser" autoplay="" muted="" playsinline="" height="100%">
          <source src="./static/videos/diagram_new_new_thin.mp4" type="video/mp4">
        </video>

      </div>
  </div>
</section>

<section class="section", id="result_1">
  <div class="container is-max-desktop">
    <!--  Results 1. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">KnoBo is More Robust to Domain Shifts.</h2>
        <div class="content has-text-justified">
          <p>
            We evaluate 5 confounds per modality, covering scenarios of race, sex, age, scan position, and hospital, etc.
          </p>
        </div>

      </div>
  </div>
</section>

<section class="section", id="result_2">
  <div class="container is-max-desktop">
    <!--  Results 2. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">KnoBo Performs the Best across Confounded and Unconfounded Data</h2>
        <div class="content has-text-centered">
          <p>
            Across 10 confounded and 10 unconfounded datasets, KnoBo achieves the best performance on average.
          </p>
        </div>

        <img src="./static/images/average_results.png"
                   class="interpolation-image"
                   alt="Interpolate start reference image."
                   width="90%"
                   height="auto"
          />

        <h2 class="subtitle has-text-justified" style="font-size: medium; text-align: right; margin-bottom: 10px; padding-bottom: 0;">
          [Averaged results across all datasets, including in-domain (ID), out-of-domain (OOD), domain-gap (âˆ†, lower is better), and mean of ID and OOD (Avg) accuracy for confounded datasets. For unconfounded datasets (Unconfd), we report test accuracy. Overall performance is calculated as the mean of the Avg and Unconfd, the overall tradeoff between data conditions.]
        </h2>

      </div>
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">BibTeX</h2>
    <pre style="font-size: 16px;"><code>@article{yang2024textbook,
      title={A Textbook Remedy for Domain Shifts: Knowledge Priors for Medical Image Analysis}, 
      author={Yue Yang and Mona Gandhi and Yufei Wang and Yifan Wu and Michael S. Yao and Chris Callison-Burch and James C. Gee and Mark Yatskar},
      journal={arXiv preprint arXiv:2312.09067},
      year={2024}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="../papers/knobo.pdf" class="external-link" disabled>
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://arxiv.org/abs/2312.09067" class="external-link" disabled>
        <i class="ai ai-arxiv"></i>
      </a>
      <a class="icon-link" href="https://github.com/allenai/Holodeck" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
      <a class="icon-link" href="mailto: yueyang1@seas.upenn.edu; myatskar@seas.upenn.edu" class="external-link" disabled>
        <i class="fas fa-envelope"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content", style="text-align: center;">
          <p>
            This website was developed by referencing <a href="https://github.com/nerfies/nerfies.github.io">this</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>